webpackJsonp([5],{"0aAL":function(e,t,s){"use strict";var a=s("Zrlr"),r=s.n(a);t.a=function e(t){var s=t.id,a=t.name,i=t.avatar,n=t.aliaName;r()(this,e),this.id=s,this.name=a,this.avatar=i,this.aliaName=n}},"8stH":function(e,t,s){"use strict";t.b=function(e,t){var s=i.b+"/search?keywords="+e+"&offset="+t;return r.a.get(s)},t.c=function(e){var t=i.b+"/search/suggest?keywords="+e;return r.a.get(t)},t.d=function(e){var t=i.b+"/song/detail?ids="+e;return r.a.get(t)},t.a=function(e){var t=i.b+"/search/hot";return r.a.get(t)};var a=s("mtWM"),r=s.n(a),i=s("W/7t")},Hvuh:function(e,t){},VuOh:function(e,t){},XEAW:function(e,t,s){"use strict";var a={props:{text:{type:String,default:""},confirmBtnText:{type:String,default:"确定"},cancelBtnText:{type:String,default:"取消"}},data:function(){return{showFlag:!1}},methods:{show:function(){this.showFlag=!0},hide:function(){this.showFlag=!1},cancel:function(){this.hide(),this.$emit("cancel")},confirm:function(){this.hide(),this.$emit("confirm")}}},r={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("transition",{attrs:{name:"confirm-fade"}},[s("div",{directives:[{name:"show",rawName:"v-show",value:e.showFlag,expression:"showFlag"}],staticClass:"confirm",on:{click:function(t){return t.stopPropagation(),e.hide(t)}}},[s("div",{staticClass:"confirm-wrapper"},[s("div",{staticClass:"confirm-content"},[s("p",{staticClass:"text"},[e._v(e._s(e.text))]),e._v(" "),s("div",{staticClass:"operate"},[s("div",{staticClass:"operate-btn left",on:{click:e.cancel}},[e._v(e._s(e.cancelBtnText))]),e._v(" "),s("div",{staticClass:"operate-btn",on:{click:e.confirm}},[e._v(e._s(e.confirmBtnText))])])])])])])},staticRenderFns:[]};var i=s("VU/8")(a,r,!1,function(e){s("Hvuh")},"data-v-31ba9ed0",null);t.a=i.exports},YOyO:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=s("qwAB"),r=s("IGeD"),i={props:{placeholder:{type:String,default:"搜索歌曲、歌手"}},data:function(){return{query:"",clickInfo:"搜索"}},created:function(){var e=this;this.$watch("query",Object(r.a)(function(t){e.$emit("query",t)},300))},methods:{clear:function(){this.query=""},setQuery:function(e){this.query=e}}},n={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"search-box"},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.query,expression:"query"}],staticClass:"box",attrs:{placeholder:e.placeholder,type:"text"},domProps:{value:e.query},on:{input:function(t){t.target.composing||(e.query=t.target.value)}}}),e._v(" "),s("i",{directives:[{name:"show",rawName:"v-show",value:e.query,expression:"query"}],staticClass:"icon-delete",on:{click:e.clear}})])},staticRenderFns:[]};var c=s("VU/8")(i,n,!1,function(e){s("Zcb/")},"data-v-232d8b04",null).exports,o=s("Dd8w"),h=s.n(o),l=s("y/jF"),u=s("0aAL"),v=s("8stH"),f=s("PvFA"),g=s("NYxO"),d={props:{query:{type:String,default:""},showSinger:{type:Boolean,default:!0},showList:{type:Boolean,default:!0}},data:function(){return{singer:{},songs:[],suggest:{},searchShow:!0,page:0,update:!0,haveMore:!0}},computed:{},methods:h()({selectList:function(e){console.log("item",e);var t={};t.name=e.name,t.id=e.id,t.picUrl=e.coverImgUrl,t.playCount=e.playCount,this.$router.push({path:"/search/list/"+t.id}),this.setMusicList(t),this.$emit("select")},selectItem:function(e){var t=new u.a({id:e.id,name:e.name,avatar:e.img1v1Url});this.$router.push({path:"/search/singer/"+t.id}),this.setSinger(t),this.$emit("select")},selectSong:function(e){var t=this;Object(v.d)(e.id).then(function(s){e.image=s.data.songs[0].al.picUrl,t.insertSong(e)}),this.$emit("select")},search:function(){var e=this;this.searchShow=!1,this.haveMore=!0,Object(v.b)(this.query,this.page).then(function(t){if(t.data.result.songs){var s=[];t.data.result.songs.forEach(function(e){s.push(Object(f.c)(e))}),e.songs=s,e.$emit("refresh")}else e.haveMore=!1}),this.page+=30,Object(v.c)(this.query).then(function(t){e.suggest=t.data.result})},searchMore:function(){var e=this;console.log("searchMore"),this.haveMore&&this.songs.length&&Object(v.b)(this.query,this.page).then(function(t){var s=t.data.result.songs;if(t.data.result.songs){var a=[];s.forEach(function(e){a.push(Object(f.c)(e))}),e.songs=e.songs.concat(a),e.$emit("refresh"),e.page+=30}else e.haveMore=!1})}},Object(g.d)({setSinger:"SET_SINGER",setMusicList:"SET_MUSIC_LIST"}),Object(g.b)(["insertSong"])),watch:{query:function(e){if(""===e)return this.suggest={},this.songs=[],void(this.haveMore=!1);this.suggest={},this.songs=[],this.searchShow=!0,this.page=0,this.haveMore=!0,this.search()},songs:function(e){}},components:{Loading:l.a}},p={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"suggest"},[s("div",{directives:[{name:"show",rawName:"v-show",value:!e.searchShow&&e.query&&e.songs.length>0,expression:"!searchShow && query && songs.length > 0"}],staticClass:"search-suggest"},[s("p",{directives:[{name:"show",rawName:"v-show",value:e.showSinger&&e.showList,expression:"showSinger && showList"}],staticClass:"title"},[e._v("最佳匹配")]),e._v(" "),e.suggest.artists&&e.showSinger?s("div",{staticClass:"search-suggest-item",on:{click:function(t){return e.selectItem(e.suggest.artists[0])}}},[s("img",{attrs:{src:e.suggest.artists[0].img1v1Url,width:"50",height:"50"}}),e._v(" "),s("span",[e._v("歌手："+e._s(e.suggest.artists[0].name))])]):e._e(),e._v(" "),e.suggest.playlists&&e.showList?s("div",{staticClass:"search-suggest-item",on:{click:function(t){return e.selectList(e.suggest.playlists[0])}}},[s("img",{attrs:{src:e.suggest.playlists[0].coverImgUrl,width:"50",height:"50"}}),e._v(" "),s("div",{staticClass:"text"},[s("p",[e._v("歌单："+e._s(e.suggest.playlists[0].name))]),e._v(" "),s("p",{staticClass:"singer"},[e._v(e._s(e.suggest.albums[0].artist.name))])])]):e._e()]),e._v(" "),s("ul",{directives:[{name:"show",rawName:"v-show",value:!e.searchShow,expression:"!searchShow"}],ref:"suggestList",staticClass:"suggest-list"},[e._l(e.songs,function(t,a){return s("li",{key:a,staticClass:"suggest-item",on:{click:function(s){return e.selectSong(t)}}},[e._m(0,!0),e._v(" "),s("div",{staticClass:"name"},[s("p",{staticClass:"song"},[e._v(e._s(t.name))]),e._v(" "),s("p",{staticClass:"singer"},[e._v(e._s(t.singer))])])])}),e._v(" "),s("loading",{directives:[{name:"show",rawName:"v-show",value:e.haveMore&&e.query,expression:"haveMore && query"}]})],2),e._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:!e.haveMore&&!e.songs.length&&e.query,expression:"!haveMore && !songs.length && query"}],staticClass:"no-result-wrapper"},[e._v("\n    抱歉，暂无搜索结果\n  ")])])},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"icon"},[t("i")])}]};var m=s("VU/8")(d,p,!1,function(e){s("f8AT")},"data-v-5e5fbd18",null).exports,w=s("XEAW"),_={props:{searches:{type:Array}},methods:{selectItem:function(e){this.$emit("select",e)},deleteOne:function(e){this.$emit("delete",e)}}},y={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{directives:[{name:"show",rawName:"v-show",value:e.searches.length,expression:"searches.length"}],staticClass:"search-list"},[s("transition-group",{attrs:{name:"list",tag:"ul"}},e._l(e.searches,function(t){return s("li",{key:t,staticClass:"search-item",on:{click:function(s){return e.selectItem(t)}}},[s("span",{staticClass:"text"},[e._v(e._s(t))]),e._v(" "),s("span",{staticClass:"icon",on:{click:function(s){return s.stopPropagation(),e.deleteOne(t)}}},[s("i",{staticClass:"icon-delete"})])])}),0)],1)},staticRenderFns:[]};var C=s("VU/8")(_,y,!1,function(e){s("VuOh")},"data-v-52e75a06",null).exports,x=s("F4+m"),b={mixins:[x.b,x.a],data:function(){return{pullup:!0,hots:[]}},created:function(){this._getSearchHot()},methods:{back:function(){this.$router.back(),this.$refs.searchBox.clear()},showConfirm:function(){this.$refs.confirm.show()},_getSearchHot:function(){var e=this;Object(v.a)().then(function(t){e.hots=t.data.result.hots})},onQueryChange:function(e){this.query=e},addQuery:function(e){this.$refs.searchBox.setQuery(e)},saveSearch:function(){this.saveSearchHistory(this.query)},searchMore:function(){this.$refs.suggest.searchMore()},refresh:function(){var e=this;setTimeout(function(){e.$refs.scroll.refresh()},20)},handlePlaylist:function(e){var t=e.length>0?"60px":"";this.$refs.searchWrapper.style.bottom=t,this.refresh()}},components:{Scroll:a.a,SearchBox:c,Suggest:m,SearchList:C,Confirm:w.a}},S={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("transition",{attrs:{name:"search"}},[s("div",{ref:"searchWrapper",staticClass:"search"},[s("div",{staticClass:"search-box-wrapper"},[s("i",{staticClass:"fa fa-angle-left",on:{click:e.back}}),e._v(" "),s("search-box",{ref:"searchBox",on:{query:e.onQueryChange}})],1),e._v(" "),s("scroll",{ref:"scroll",staticClass:"search-scroll-wrapper",attrs:{pullup:e.pullup},on:{scrollToEnd:e.searchMore}},[s("div",{ref:"search"},[s("div",{directives:[{name:"show",rawName:"v-show",value:!e.query,expression:"!query"}],staticClass:"search-hots"},[s("p",{staticClass:"title"},[e._v("热门搜索")]),e._v(" "),e._l(e.hots,function(t){return s("span",{key:t.id,staticClass:"search-hots-item",on:{click:function(s){return e.addQuery(t.first)}}},[e._v("\n            "+e._s(t.first)+"\n          ")])})],2),e._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:!e.query,expression:"!query"}],staticClass:"shortcut-wrapper"},[s("div",{directives:[{name:"show",rawName:"v-show",value:e.searchHistory.length,expression:"searchHistory.length"}],staticClass:"search-history"},[s("h1",{staticClass:"title"},[s("span",{staticClass:"text"},[e._v("搜索历史")]),e._v(" "),s("span",{staticClass:"clear",on:{click:e.showConfirm}},[s("i",{staticClass:"icon-clear"})])]),e._v(" "),s("search-list",{attrs:{searches:e.searchHistory},on:{select:e.addQuery,delete:e.deleteSearchHistory}})],1)]),e._v(" "),s("div",{staticClass:"search-result"},[s("suggest",{ref:"suggest",attrs:{query:e.query},on:{select:e.saveSearch,refresh:e.refresh}})],1)])]),e._v(" "),s("confirm",{ref:"confirm",attrs:{text:"是否清空历史记录？",confirmBtnText:"清空"},on:{confirm:e.clearSearchHistory}}),e._v(" "),s("router-view")],1)])},staticRenderFns:[]};var q=s("VU/8")(b,S,!1,function(e){s("sTlV")},"data-v-71f6b7e8",null);t.default=q.exports},"Zcb/":function(e,t){},f8AT:function(e,t){},sTlV:function(e,t){}});
//# sourceMappingURL=5.5450286e06816a9746dd.js.map